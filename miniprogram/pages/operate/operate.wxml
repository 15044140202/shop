<!--pages/operate/operate.wxml-->
<!-- 营业界面导航按钮栏 -->
<view class="titel">
  <view class="image_1 {{item.showRedDot ? 'red-dot' : ''}}" wx:for="{{menu_data}}" wx:key="index" bind:tap="goto" mark:path="{{item.path}}">
    <van-icon name="{{item.iconName}}" size="70rpx" color="#ffffff" />
    <text style="color: #ffffff; font-size: 26rpx;">{{item.titel_name}}</text>
  </view>
  <van-icon name="sort" color="{{sortColor}}" style="margin-top:50rpx; margin-right:20rpx" />
</view>
<!-- 桌台实时信息 界面-->
<view class="table_border">
  <view class="table" style="background-color:{{item.state === '自助开台' ? '#1aad19': item.state === '店员开台' ?'#0097ff':''}};" wx:for="{{tableState}}" wx:key="index" bind:tap="tableTap" bind:longpress="tableLongPress" mark:tableMark="{{index}}">
    <van-icon name="volume-o" color="#fff" />
    <view class="table_titel">
      <text style="font-size: 50rpx; color:{{item.state === '自助开台' || item.state === '店员开台' ? '#fff':'#999'}}; margin-bottom:{{item.state === '空闲' ? '20rpx':'0rpx'}};">{{item.tableCost === '' ? '空闲' : item.tableCost}}</text>
      <text style="font-size: 30rpx; color: {{item.state === '自助开台' || item.state === '店员开台' ? '#fff':'#999'}};" wx:if="{{item.state !== '空闲'}}">{{item.endTime}}{{item.endTime === '非定时开台' ? '' : '止'}}</text>
      <text style="font-size: 30rpx; color: {{item.state === '自助开台' || item.state === '店员开台' ? '#fff':'#999'}};">{{index + 1}}号台</text>
    </view>
  </view>
  <view class="table" style="background-color: #0097ff;" bind:tap="tableManager">
    <text style="margin-left: 10rpx; margin-top: 10rpx; color: #fff;">管理</text>
    <view class="table_titel" style="margin: -20rpx;">
      <image src="../../icon/桌台.png" style="height: 150rpx; width: 150rpx;" mode="scaleToFill" />
    </view>
  </view>
</view>
<!-- 桌台信息弹出层 -->
<van-popup round class="POPUP" position="bottom" show="{{tableCtrlShow}}" bind:close="tableCtrlClose">
  <text class="popupview" style="background-color:{{color1}}; color:#fff" bind:tap="open">{{closeOrOpen}}({{optNum}}号台)</text>
  <text class="popupview" style="background-color: {{color1}};color:#fff" bind:tap="tapLight">{{switchName}}</text>
  <text class="popupview" style="background-color: {{color1}};color:#fff" bind:tap="tapTableInfo">修改桌台信息</text>
  <text class="popupview" style="background-color: rgb(43, 42, 42); height: 10rpx;"></text>
  <text class="popupview" style="background-color: {{color1}};color:#fff" bind:tap="tableCtrlClose">取消</text>
</van-popup>
<!-- 桌台信息长按弹出层 -->
<van-popup round class="POPUP" position="bottom" show="{{longPressShow }}" bind:close="longPressClose">
  <text class="popupview" style="background-color:{{color1}}; color:#fff" bind:tap="timedOpen">押金定时开台</text>
  <text class="popupview" style="background-color: {{color1}};color:#fff" bind:tap="couponOpen">团购券开台</text>
  <text class="popupview" style="background-color: {{color1}};color:#fff" bind:tap="sweepOpenLight">打扫开灯</text>
  <text class="popupview" style="background-color: rgb(43, 42, 42); height: 10rpx;"></text>
  <text class="popupview" style="background-color: {{color1}};color:#fff" bind:tap="longPressClose">取消</text>
</van-popup>
<van-dialog use-slot confirmButtonText="取消" title="功能选项" show="{{ show }}" bind:close="onClose">
  <view wx:for="{{options}}" wx:key="index" bind:tap="tap" mark:item='{{item}}'>
    <button type="primary" style="margin: 35rpx;">{{item}}</button>
  </view>
</van-dialog>
<!-- 输入押金界面 -->
<van-dialog use-slot title="押金确认" show="{{ cashPledgeShow }}" bind:confirm="onConfirm" show-cancel-button bind:close="onClose" mark:item='cashPledge'>
  <view class="cashPledge">
    <text>押金:</text>
    <input style="text-align: center;" type="number" value="{{cashPledge}}" placeholder="请输入押金金额" bindinput="input" mark:item="pledge" />
  </view>
  <view class="payModeBorder">
    <view class="payMode" bind:tap="tap" mark:item='cashPledge' mark:value="{{optPrice}}">
      <text>{{optPrice}}元\n1小时</text>
    </view>
    <view class="payMode" bind:tap="tap" mark:item='cashPledge' mark:value="{{optPrice*2}}">
      <text>{{optPrice*2}}元\n2小时</text>
    </view>
    <view class="payMode" bind:tap="tap" mark:item='cashPledge' mark:value="{{optPrice*3}}">
      <text>{{optPrice*3}}元\n3小时</text>
    </view>
  </view>
  <view class="cashPledge">
    <text style="text-align: center; width: 100%; color: #999;">金额为0时默认为不定时结账时计算价格\n金额大于0时为计时模式,余额不足时关台</text>
  </view>
</van-dialog>
<!-- 押金支付选择界面 -->
<van-dialog use-slot title="支付方式选择" show="{{ payModeShow }}" bind:confirm="onConfirm" show-cancel-button bind:close="onClose" mark:item='payMode'>
  <view class="payModeBorder">
    <view class="payMode" style="color:{{payMode === '现金' ? '' :'#999'}}; background-color:{{payMode === '现金' ? '' :'#eee'}};" bind:tap="tap" mark:item='payMode' mark:value='现金'>现金</view>
    <view class="payMode" style="color: {{payMode === '微信' ? '' :'#999'}}; background-color:{{payMode === '微信' ? '' :'#eee'}};" bind:tap="tap" mark:item='payMode' mark:value='微信'>微信</view>
  </view>
</van-dialog>
<!-- 展示收款码界面 -->
<van-dialog use-slot title="请用微信扫描收款码付款" show="{{ payShow }}" bind:confirm="onConfirm" show-cancel-button bind:close="onClose" mark:item='pay'>
  <view class="payModeBorder">
    <image src="" mode="scaleToFill" />
  </view>
</van-dialog>
<!-- 绑定用户手机号码 -->
<van-dialog use-slot title="绑定手机号码" show="{{bindTelShow}}" bind:confirm="onConfirm" mark:item="bindTel">
  <view  style="width: 90; margin-left: 5%;">
  <text style="color: red;">为了账号安全,在正式使用前请先绑定手机号码.(后续使用中,如因店铺绑定微信无法正常使用或者店铺转让等操作,可通过绑定手机联系客服进行账号找回.)</text>
  </view>
  
  <view style="display: flex; flex-direction: row; justify-content: space-evenly; align-items: center;    width:90%; margin-left: 5%; height: 120rpx;">
    <text>手机号码:</text>
    <button style="width: 60%; height: 60rpx; margin-right: 50rpx; text-align: left; " size="mini" open-type="getPhoneNumber" bindgetphonenumber="getPhoneNumber">
      <text>{{shopInfo.telephone === '' || shopInfo.telephone === '1'  ? '未验证' : telephoneNum}}</text>
    </button>
  </view>
</van-dialog>
<van-dialog id="van-dialog" />